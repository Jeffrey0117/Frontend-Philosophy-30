# 洛克的契約論：跨域限制的社會契約
在17世紀，英國哲學家約翰·洛克提出了一種被稱為「社會契約論」的理論。他認為，人們為了保護自己的生命、自由與財產，願意將部分權力交給政府，形成一種社會契約。這種契約的成立是基於互惠互利的原則，是為了達到更好的共同生活。

將這種哲學思考應用到網頁開發中，我們可以將跨域資源共享（CORS）視為一種社會契約。網頁開發者和伺服器管理者同意遵守一定的規則，以達到更好的使用者體驗和數據安全。

## CORS：網路的社會契約

跨域資源共享，或者簡稱CORS，是一種網路安全機制。它可以讓伺服器決定是否允許由不同源（域名、協議或端口）發出的請求訪問其資源。

這就像洛克的契約論中的政府。政府有權力決定誰可以在其管轄範圍內活動，並對違反規則的人施加懲罰。同樣，CORS讓伺服器有權力決定是否允許跨域請求。

## JSONP、代理伺服器和Nginx配置：契約的變通方式

然而，和社會契約論一樣，總會有些人或者情況需要在某些規則之外尋找解決方案。在跨域資源共享中，我們有JSONP、代理伺服器和Nginx配置等方法。

JSONP是一種讓網頁從其他源獲取資料的技術。它利用了瀏覽器對`<script>`標籤的特殊處理，可以讓我們從任何源獲取資料。

代理伺服器則是作為客戶端與遠端伺服器之間的中介，可以讓我們繞過跨域限制。

Nginx配置則是在伺服器端進行設定，可以更細緻地控制哪些源可以訪問資源。

## 正確使用CORS：契約的實踐

要正確使用CORS，我們需要在伺服器端設定適當的HTTP響應頭。例如，我們可以設定`Access-Control-Allow-Origin`為特定的源，或者使用`*`允許所有源。

這就像政府宣布法律，告訴公民哪些行為是合法的，哪些行為會被懲罰。網頁開發者需要了解這些規則，並在開發過程中遵守。

## 程式範例

以下是一個使用Express.js的範例，設定CORS允許所有源訪問資源：

```javascript
const express = require('express');
const cors = require('cors');
const app = express();

app.use(cors());

app.get('/data', function (req, res) {
  res.json({ msg: 'This is CORS-enabled for all origins!' });
});

app.listen(80, function () {
  console.log('CORS-enabled web server listening on port 80');
});
```

## 哲學與技術的對話

CORS就像是網路世界的社會契約，它設定了網頁開發者和伺服器管理者需要遵守的規則。同時，我們也有JSONP、代理伺服器和Nginx配置等變通的方法，就像社會中的不同政策和法律修正。

在網頁開發中，我們需要了解這些規則，並在實踐中遵守。只有這樣，我們才能創建出既安全，又能帶給使用者良好體驗的網頁。